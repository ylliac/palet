<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Palet | Computer vision using tracking.js</title>
    <script src="node_modules/tracking/build/tracking-min.js"></script>
</head>

<body>
    <h1>Who's the closest?</h1>

    <label for="files">Your image:</label>
    <input type="file" id="inputFile" onchange="previewImage(this.files); findClosest(this)" />
    <br>
    <label for="imagePreview">Image preview:</label>
    <br>
    <img id="imagePreview" />
    <img id="imageResult" />

    <script>
        // Preview input image
        function previewImage(files) {
            console.log("Previewing input image...");
            // initialize image reader
            var reader = new FileReader();

            reader.onload = function(e) {
                // get loaded data and render thumbnail into image element
                document.getElementById("imagePreview").src = e.target.result;
            };

            // read the image file as a data URL
            reader.readAsDataURL(files[0]);
            console.log("Done!");
        };

        // Find closest palet
        function findClosest(doc) {
            console.log("Looking for closest palet...")
            var greyTracker = new tracking.Image.grayscale(pixels, width, height, fillRGBA);

            greyTracker.on('track', function(event) {
                if (event.data.length === 0) {
                    // No colors were detected in this frame.
                } else {
                    event.data.forEach(function(rect) {
                        console.log(rect.x, rect.y, rect.height, rect.width, rect.color);
                    });
                }
            });

            tracking.track('#imagePreview', greyTracker);
            console.log("Done!")
        };
    </script>
</body>

</html>
