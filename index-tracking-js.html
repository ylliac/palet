<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Palet | Computer vision using tracking.js</title>
    <script src="node_modules/tracking/build/tracking-min.js"></script>
</head>

<body>
    <h1>Who's the closest?</h1>

    <label for="files">Your image:</label>
    <input type="file" id="inputFile" onchange="previewImage(this.files); findClosest(this.files)" />
    <br>
    <br>
    <canvas id="canvasPreview" width="400" height="400"></canvas>
    <canvas id="canvasResult" width="400" height="400"></canvas>

    <script>
        // Preview input image
        function previewImage(files) {
            console.log("Previewing input image...");

            var canvas = document.getElementById("canvasPreview");
            var context = canvas.getContext("2d");

            var image = new Image();
            image.src = "images/" + files[0]["name"];

            context.drawImage(image, 0, 0, canvas.width, canvas.height);

            console.log("Done!");
        };

        // Find closest palet
        function findClosest(files) {
            console.log("Looking for closest palet...")

            var canvas = document.getElementById("canvasResult");
            var context = canvas.getContext("2d");

            var image = new Image();
            image.src = "images/" + files[0]["name"];

            context.drawImage(image, 0, 0, canvas.width, canvas.height);

            var imageData = context.getImageData(0, 0, canvas.width, canvas.height);
            var gray = tracking.Image.grayscale(imageData.data, canvas.width, canvas.height);
            // tracking.ViolaJones.detect(gray, width, height, initialScale, scaleFactor, stepSize, edgesDensity, classifier);

            // update canvas result
            imageData.data = gray;
            context.putImageData(imageData, 0, 0);

            console.log("Done!")
        };
    </script>
</body>

</html>
